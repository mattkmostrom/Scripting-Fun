#!/usr/bin/python

from numpy import *
import matplotlib.pyplot as plt
from matplotlib.ticker import AutoMinorLocator, MaxNLocator
from scipy.interpolate import splrep, splev

# manual values
man_exp_x = array([1.5, 1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.0,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4.0,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5.0,5.1,5.2,5.3,5.4,5.5,5.6,5.7,5.8,5.9,6.0,6.1,6.2,6.3,6.4,6.5,6.6,6.7,6.8,6.9,7.0,7.1,7.2,7.3,7.4,7.5,7.6,7.7,7.8,7.9,8.0,8.1,8.2,8.3,8.4,8.5,8.6,8.7,8.8,8.9,9.0,9.1,9.2,9.3,9.4,9.5,9.6,9.7,9.8,9.9,10.0])
man_exp_y = array([5552.338152843087,3560.1781762770715,2261.5151676100445,1421.0054533206705,881.2703050008687,537.6772566702377,321.07835905863055,186.07037078774823,103.05117011862501,52.85990737610801,23.19190937385652,6.209975065880374,-3.042929293877181,-7.67104135857817,-9.594528535629715,-9.997166014227716,-9.586561880173685,-8.785918244414308,-7.837027341572862,-6.873943386328891,-5.966971580305949,-5.145944486022225,-4.424718660958644,-3.7987018918801403,-3.26000509997439,-2.8016812331182113,-2.4132240350612117,-2.0817348656698766,-1.800673427650617,-1.5614709542140612,-1.3588930886369512,-1.185949939133894,-1.0377710617321971,-0.9097108080409088,-0.8016300637046129,-0.7069028490903034,-0.6250314327474034,-0.5538963678032056,-0.49227739460694464,-0.4386437753719673,-0.3914594758783647,-0.3500501051257448,-0.31499907586550663,-0.28265620311619394,-0.2545522247126647,-0.22902258424494407,-0.20691833161685594,-0.18711548221046412,-0.16898248607019087,-0.15436585634721264,-0.139706385798533,-0.12784075290164842,-0.11710440169576544,-0.10591845649108184,-0.09622040858697513,-0.08864180757310447,-0.07944149063971742,-0.07497250273638359,-0.06735106126711246,-0.06121751675660203,-0.058011628856451176,-0.05174426544215443,-0.047863987010513205,-0.04623697435098306,-0.04123271119404031,-0.038074960831119886,-0.03491721046819946,-0.032391009953491465,-0.029864809719248042,-0.02765438454934312,-0.025759734163312124,-0.0238650840577457,-0.0225110058603479,-0.0209321305386554,-0.01912845837313278,-0.01809015524007348,-0.01682705498271948,-0.015339157881535358,-0.014616629812814558,-0.013128732711630436,-0.012721979707248135,-0.011549857389937936,-0.010602532477387013,-0.009970982348710014,-0.009339432220033014,-0.008707882091356015])
man_exp_spline = splrep(man_exp_x,man_exp_y)
man_exp_x1 = linspace(man_exp_x.min(), man_exp_x.max(), 300)
man_exp_y1 = splev(man_exp_x1,man_exp_spline)

# fit values
fit_exp_x = array([1.5, 1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.0,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4.0,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5.0,5.1,5.2,5.3,5.4,5.5,5.6,5.7,5.8,5.9,6.0,6.1,6.2,6.3,6.4,6.5,6.6,6.7,6.8,6.9,7.0,7.1,7.2,7.3,7.4,7.5,7.6,7.7,7.8,7.9,8.0,8.1,8.2,8.3,8.4,8.5,8.6,8.7,8.8,8.9,9.0,9.1,9.2,9.3,9.4,9.5,9.6,9.7,9.8,9.9,10.0])
fit_exp_y = array([5475.187620709904,3500.0037989904918,2214.904594523616,1385.1841382945477,853.9872679542535,517.1040388734766,305.7243901425527,174.72375783195693,94.7371856507046,46.80687873990425,18.801935070171908,3.030284690997969,-5.351189496213769,-9.355656186180088,-10.833130726973053,-10.91847494464065,-10.28035931462029,-9.314954878189566,-8.245389560569443,-7.192845639320552,-6.217974362382035,-5.344494122850359,-4.583043493139556,-3.9251686782739164,-3.360728011118037,-2.882774439859877,-2.4788709164967915,-2.1348316079049137,-1.8437944184340578,-1.5962251856378389,-1.3875331497033943,-1.209763023602441,-1.057400766600889,-0.9254789317189294,-0.8154673965484646,-0.718487592870475,-0.634685385995782,-0.5616195303379276,-0.49903516184618985,-0.4441143488210978,-0.39628645239518867,-0.3539116866231744,-0.31886065709780953,-0.2858741876944637,-0.25777020923834737,-0.23095337473291444,-0.20884912212235535,-0.18872447439223367,-0.16994788133060953,-0.15565305016142975,-0.14034998249857983,-0.12912794671148328,-0.11839159543548415,-0.10656205363592794,-0.09654220687126465,-0.08896360589902545,-0.0787978938870835,-0.07561609969060143,-0.06702926271769627,-0.06025212144578739,-0.05833342739272059,-0.05077887015544222,-0.04722039004533972,-0.04688057106855891,-0.040589114228866824,-0.0374313638659464,-0.034273613503025976,-0.031747413268782554,-0.029221213034539135,-0.027010787584169638,-0.025116137478603213,-0.023221487092572216,-0.022189207497177715,-0.020610332175485215,-0.018484861688423868,-0.017768356876903296,-0.016505256619549297,-0.014695561196826449,-0.014294831449644373,-0.012485136026921525,-0.012400181063613375,-0.010906260705229027,-0.009958935512213529,-0.00932738538353653,-0.008695835535324103,-0.008064285406647104])
fit_exp_spline = splrep(fit_exp_x,fit_exp_y)
fit_exp_x1 = linspace(fit_exp_x.min(), fit_exp_x.max(), 300)
fit_exp_y1 = splev(fit_exp_x1,fit_exp_spline)

# hellmann values
hel_exp_x = array([1.19065,1.32294,1.45524,1.58753,1.71983,1.85212,1.98441,2.11671,2.24900,2.38130,2.51359,2.64589,2.77818,2.91047,2.96339,3.04277,3.17506,3.30736,3.43965,3.70424,4.23342])
hel_exp_y = array([20907.75,11959.91,6758.848,3767.492,2066.267,1110.454,581.0663,292.5918,138.5028,58.4113,18.361,-0.4689,-8.358,-10.8255,-11.001,-10.7727,-9.6811,-8.2773,-6.8936,-4.6232,-2.0675])
hel_exp_spline = splrep(hel_exp_x,hel_exp_y)
hel_exp_x1 = linspace(hel_exp_x.min(), hel_exp_x.max(), 300)
hel_exp_y1 = splev(hel_exp_x1,hel_exp_spline)

# corrected HF values
cor_exp_x = array([1.5, 1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.0,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4.0,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5.0,5.1,5.2,5.3,5.4,5.5,5.6,5.7,5.8,5.9,6.0,6.1,6.2,6.3,6.4,6.5,6.6,6.7,6.8,6.9,7.0,7.1,7.2,7.3,7.4,7.5,7.6,7.7,7.8,7.9,8.0,8.1,8.2,8.3,8.4,8.5,8.6,8.7,8.8,8.9,9.0,9.1,9.2,9.3,9.4,9.5,9.6,9.7,9.8,9.9,10.0])
cor_exp_y = array([5473.96416201258,3498.808790845713,2213.778207413621,1384.211638950732,853.2260670447482,516.5662809620412,305.3847669765757,174.53674852641896,94.65353253275673,46.785052495169346,18.811701677901976,3.052705425117116,-5.32647573255911,-9.334084722522215,-10.816485030178502,-10.90683994261447,-10.273140517546587,-9.311048235224623,-8.243691020071974,-7.1925059314690944,-6.218314070437268,-5.345003684954024,-4.583553055089842,-3.9256782404630353,-3.361067719186417,-2.882944293722063,-2.479125697576013,-2.1350014621943703,-1.8437944185282764,-1.5963101128855501,-1.3875331497581724,-1.2097630236528372,-1.0575706205748228,-0.9254789316553865,-0.8156372504281798,-0.7184875927806387,-0.6347703127461068,-0.561704457114546,-0.4990351617059576,-0.44402942166979625,-0.3962864524543492,-0.3539966133713081,-0.31894558414393687,-0.28587418760681854,-0.2576852822557628,-0.2311232286148207,-0.208679268205391,-0.18872447433088205,-0.16986295426476203,-0.15573797699720865,-0.14034998258622502,-0.12912794683199538,-0.11839159554065837,-0.10647712629180697,-0.09654220696767435,-0.08896360604583113,-0.07879789391337705,-0.07561609973442403,-0.0670292627878124,-0.06008226752224967,-0.058163573504240944,-0.05060901637213678,-0.04705053626203428,-0.04671071740357447,-0.040504187375558866,-0.03734643698196263,-0.034188686601513175,-0.03166248630153587,-0.029136285997176305,-0.026925860717714904,-0.02503121049820975,-0.023136560269940074,-0.02210428044666811,-0.02052540524767886,-0.018399934686119113,-0.017683429909656607,-0.016420329757476825,-0.01461063424272654,-0.014209904486779945,-0.01240020896326514,-0.01231525425851027,-0.010821333773040412,-0.009874008663287834,-0.009242458587197943,-0.008610908506725792,-0.00797935843501816])
cor_exp_spline = splrep(cor_exp_x,cor_exp_y)
cor_exp_x1 = linspace(cor_exp_x.min(), cor_exp_x.max(), 300)
cor_exp_y1 = splev(cor_exp_x1,cor_exp_spline)



fig, ax = plt.subplots(1, 1, sharex=False, sharey=False,figsize=[6.4,6.4])
#gridspec_kw={'wspace': 0}

ax1 = ax

ax1.plot(man_exp_x1, man_exp_y1, color='k', zorder=1, label="Beta from manual")
ax1.plot(fit_exp_x1, fit_exp_y1, color='g', zorder=3, label="Beta fit")
ax1.plot(hel_exp_x1, hel_exp_y1, color='r', zorder=5, label="Hellmann dimer")
ax1.plot(cor_exp_x1, cor_exp_y1, color='b', zorder=5, label="Beta fit w/ corrected HF")

ax1.set(xlabel=r'Distance (Angstroem)',ylabel=r'B$_2$ (Energy (K))')

ax1.set_ylim(-15,30)
ax1.set_xlim(2.3,4)
#ax1.xaxis.set_major_locator(MaxNLocator(nbins=6,prune=None))
ax1.xaxis.set_minor_locator(AutoMinorLocator())
ax1.yaxis.set_minor_locator(AutoMinorLocator())
ax1.tick_params(which='both', axis="x", direction="in")
ax1.tick_params(which='both', axis="y", direction="in")
ax1.tick_params(which='both', bottom=True, top=True, left=True, right=True)

leg = ax1.legend(frameon=True,ncol=2,loc=4)
leg.get_frame().set_linewidth(0.0)

plt.tight_layout()
plt.savefig('b2.eps', format='eps')

plt.show()
